@using UTPPrototipo.Common

@model UTPPrototipo.Models.ViewModels.UTP.VistaOferta


@{
    Layout = "~/Views/UTP/_LayoutUTP.cshtml";
    ViewBag.Title = "Oferta de Empresa";
}



<link href="~/Content/font-awesome.css" rel="stylesheet" />
<div class="container" style="margin-top:2px;">
    <div class="panel-group" id="datos-cuenta" role="tablist" aria-multiselectable="true">

        @{Html.RenderAction("VistaCabeceraUtp", "UTP");}
       
    </div>

 
    <div class="panel-group" id="CriterioBusquedaPostulacion" role="tablist" aria-multiselectable="true">
        <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="CabeceraColapsaBusqueda" style="padding: 2px 2px 2px 6px;">
                <h5 class="panel-title">
                    <a data-toggle="collapse" data-parent="#CriterioBusquedaPostulacion" href="#ColapsaBusqueda" aria-expanded="true" aria-controls="ColapsaBusqueda" class="fuente-seccion">
                        Búsqueda
                    </a>
                </h5>
            </div>
            <div id="ColapsaBusqueda" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="CabeceraColapsaBusqueda">
                <div class="panel-body">
                    <table style="width:100%;">
                        <tr>
                                <td>
                                    <div class="input-group fuente-pequeña">
                                        <span class="input-group-addon fuente-pequeña">Palabra Clave</span>
                                       @* @Html.TextBox("SearchString", null, new { @class = "form-control", @placeholder = "Busca Por Ofertas" })*@

                                        @Html.TextBoxFor(model => model.PalabraClave, new { @class = "form-control", @placeholder = "Cargo" })

                                    </div>
                                </td>
                                <td style="text-align:right;">
                                    <span class="col-md-6 btn-group">
                                        @*<input id="btnBuscar" type="submit" onclick ="buscarPaginacion(1);"class="fui" style="font-size:30px;border-width:0px;background-color:transparent;" value="(" />*@
                                   
                                        <span class="btn btn-default fa fa-search color-paleta4" id="buscar"></span>
                                     </span>                                    
                                </td>
                        </tr>
                    </table>
                </div>
            </div>

            



        </div>


        <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="CabeceraColapsaBusquedaAvanzada" style="padding: 2px 2px 2px 6px;">
                <h5 class="panel-title">
                    <a class="collapsed fuente-seccion" data-toggle="collapse" data-parent="#CriterioBusquedaPostulacion" href="#ColapsaBusquedaAvanzada" aria-expanded="false" aria-controls="ColapsaBusquedaAvanzada">
                        Búsqueda avanzada
                    </a>
                </h5>
            </div>
            <div id="ColapsaBusquedaAvanzada" class="panel-collapse collapse" role="tabpanel" aria-labelledby="CabeceraColapsaBusquedaAvanzada">
                <div class="panel-body fuente-pequeña">
                    <div class="row">
                        <div class="col-sm-3">


                            <div class="input-group">
                                <span class="input-group-addon">Empresa</span>
                                @Html.TextBoxFor(model => model.NombreComercial, new { @class = "form-control", @placeholder = "Buscar Empresa" })
                            </div>
                            <div class="input-group">
                                <span class="input-group-addon">Sector<br />Empresarial</span>
                                @*  @Html.DropDownListFor(model => model.IdPeriodoRegistro, new SelectList(ViewBag.PeridoRegistro, "Value", "Text"), "- Seleccionar -", new { @class = "form-control", @Id = "IdPeriodoRegistro" })*@
                                @Html.DropDownListFor(model => model.IdSectorutp, new SelectList(ViewBag.ListaSector, "Value", "Text"), "- Seleccionar -", new { @class = "form-control", @Id = "IdSectorutp" })
                            </div>
                            <div class="input-group">
                                <span class="input-group-addon">Año<br />Experiencia</span>
                                @Html.TextBoxFor(model => model.AExperiencia, new { @class = "form-control", @placeholder = "Buscar Año Experiencia" })
                            </div>
                            <!--Dejabajo de Registro 2-->

                        </div>
                        <div class="col-sm-3">

                            <div class="input-group">
                                <span class="input-group-addon">Tipo Cargo</span>
                                @*  @Html.DropDownListFor(model => model.IdPeriodoRegistro, new SelectList(ViewBag.PeridoRegistro, "Value", "Text"), "- Seleccionar -", new { @class = "form-control", @Id = "IdPeriodoRegistro" })*@
                                @Html.DropDownListFor(model => model.IdTipoCargoutp, new SelectList(ViewBag.ListaTipoCargo, "Value", "Text"), "- Seleccionar -", new { @class = "form-control" })
                            </div>

                            <div class="input-group">
                                <span class="input-group-addon">Tipo Contrato</span>
                                @*  @Html.DropDownListFor(model => model.IdPeriodoRegistro, new SelectList(ViewBag.PeridoRegistro, "Value", "Text"), "- Seleccionar -", new { @class = "form-control", @Id = "IdPeriodoRegistro" })*@
                                @Html.DropDownListFor(model => model.IdTipoContratoutp, new SelectList(ViewBag.ListaTipoContrato, "Value", "Text"), "- Seleccionar -", new { @class = "form-control" })
                            </div>
                                                      

                            <div class="input-group">
                                <span class="input-group-addon">Remuneración</span>
                                @Html.TextBoxFor(model => model.RemuneracionOfrecida, new { @class = "form-control", @placeholder = "Buscar Remuneración", @Id = "RemuneracionOfrecida" })
                               
                            </div>

                            <!--Dejabajo de carrera 2-->

                        </div>
                        <div class="col-sm-3">
                            

                            <div class="input-group">
                                <span class="input-group-addon">Cargo/<br />Oferta</span>
                                @Html.TextBoxFor(model => model.CargoOfrecido, new { @class = "form-control", @placeholder = "Cargo Oferta" })
                            </div>

                            <div class="input-group">
                                <span class="input-group-addon">Tipo/<br />Estudio</span>
                                @Html.DropDownListFor(model => model.IdTipoEstudioutp, new SelectList(ViewBag.ListaTipoEstudio, "Value", "Text"), "- Seleccionar -", new { @class = "form-control" })
                            </div>

                            <div class="input-group">
                                <span class="input-group-addon">Nro/<br />Postulante</span>
                                @Html.TextBoxFor(model => model.NumeroPostulante, new { @class = "form-control", @placeholder = "Busca por Postulante" })
                            </div>

                            <!--Dejabajo de Tipo habian 2-->


                        </div>

                        <div class="col-sm-3">


                            <div class="input-group">
                                <span class="input-group-addon">Info/<br />Adicional</span>
                                @Html.DropDownListFor(model => model.InformacionAdicional, new SelectList(ViewBag.ListaInformacionAdicional, "Value", "Text"), "- Seleccionar -", new { @class = "form-control", @Id = "TipoConocimientoIdListaValor" })
                            </div>
                            <div class="input-group">
                                <span class="input-group-addon">Conoci-<br />miento</span>
                                @Html.TextBoxFor(model => model.Conocimientos, new { @class = "form-control fuente-pequeña", @placeholder = "Conocmiento específico: ej. SAP", @Id = "Conocimientos" })
                                @*@Html.DropDownListFor(model => model.IdPeriodoRegistro, new SelectList(ViewBag.PeridoRegistro, "Value", "Text"), "- Seleccionar -", new { @class = "form-control", @Id = "IdPeriodoRegistro" })*@

                            </div>
                            <br />
                            <button class="btn btn-default color-paleta4 fa fa-search" id="buscaravanzada"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <br />

        @*<h5>Ofertas por Activar</h5>*@
     

        <div id="ResultadoBusqueda">

        </div>


    </div>

    <hr />
   
</div>
<script>

    $(document).ready(function () {
        $("#divFinalCabecera").removeClass("color-paleta1 color-paleta2 color-paleta3 color-paleta5 color-paleta6 color-paleta7 color-paleta8 color-paleta9").addClass("color-paleta4")
        var codigoTipoConocimiento = $('#TipoConocimientoIdListaValor').val();

        //ESE ES LA CAJA, LA ACCION Y EL CONTROLADOR
        AutoCompleteTextDemo('#Conocimientos', '@Url.Action("ListarDatosEspecificos", "OfertaInformacionAdicional")' + '?codigoTipo=' + codigoTipoConocimiento, '#Conocimientos', '#TipoConocimientoIdListaValor', 'option', 'appendTo', '.eventInsForm');
    });


    $('#buscar').click(function () {
        var oferta = {
            PalabraClave: $('#PalabraClave').val(),
            nroPaginaActual: 1,
        };

        //Cargar("resultadobusqueda", "/UTP/BusquedaSimpleEmpresasActivas", empresa);

        Cargar("ResultadoBusqueda", '@Url.Action("BuscarOfertas", "UTP")', oferta);
    });

    $('#buscaravanzada').click(function () {
        var oferta = {
            NombreComercial: $('#NombreComercial').val(),
            IdTipoCargoutp: $('#IdTipoCargoutp').val(),
            CargoOfrecido: $('#CargoOfrecido').val(),
            IdSectorutp: $('#IdSectorutp').val(),
            IdTipoContratoutp: $('#IdTipoContratoutp').val(),
            AExperiencia: $('#AExperiencia').val(), 
            RemuneracionOfrecida: $('#RemuneracionOfrecida').val(),
            IdTipoEstudioutp: $('#IdTipoEstudioutp').val(),
            Conocimientos: $('#Conocimientos').val(),
            NumeroPostulante: $('#NumeroPostulante').val(),
            
            nroPaginaActual: 1,

        };
        //debugger;

        //Cargar("resultadobusqueda", "/UTP/BusquedaAvanzadaEmpresas", oferta);

        Cargar("ResultadoBusqueda", '@Url.Action("UTP_ObtenerofertasAvanzada", "UTP")', oferta);
    });

    function Cargar(id, link, entidad) {
        //debugger;
        $.ajax({
            url: link,
            contentType: 'application/json; charset=utf-8',
            type: 'POST',
            data: JSON.stringify(entidad),
            dataType: 'html'
        })
        .success(function (result) {
            $("#" + id).html(result);
            //alert(result);
            //console.log(result);
        })
        .error(function (xhr, status) {
            console.log(xhr);
            console.log(status);
            alert('error');
        })
    }

    function buscarPaginacion(nroPagina) {
        var oferta = {
            PalabraClave: $('#PalabraClave').val(),
            nroPaginaActual: nroPagina,

        };
        //Cargar("resultadobusqueda", "/UTP/BusquedaSimpleEmpresasActivas", empresa);
        Cargar("ResultadoBusqueda", '@Url.Action("BuscarOfertas", "UTP")', oferta);
    }

    function buscarPaginacionAvanzada(nroPagina) {

        var oferta = {
            NombreComercial: $('#NombreComercial').val(),
            IdTipoCargoutp: $('#IdTipoCargoutp').val(),
            CargoOfrecido: $('#CargoOfrecido').val(),
            IdSectorutp: $('#IdSectorutp').val(),
            IdTipoContratoutp: $('#IdTipoContratoutp').val(),
            AExperiencia: $('#AExperiencia').val(),
            RemuneracionOfrecida: $('#RemuneracionOfrecida').val(),
            IdTipoEstudioutp: $('#IdTipoEstudioutp').val(),
            Conocimientos: $('#Conocimientos').val(),
            NumeroPostulante: $('#NumeroPostulante').val(),
            nroPaginaActual: nroPagina,

        };

        //Cargar("resultadobusqueda", "/UTP/BusquedaAvanzadaEmpresas", oferta);
        Cargar("ResultadoBusqueda", '@Url.Action("UTP_ObtenerofertasAvanzada", "UTP")', oferta);
    }



</script>
